import{j as e,T as a,I as s,a as t,b as i,P as r,C as l,V as n,L as c,c as d,d as o,e as m,f as h,R as x,g}from"./ui-CnG_p06C.js";import{r as u,u as p,f}from"./vendor-CLycFUD2.js";import{c as j,B as w,a as v,b,g as N,u as y,N as C,F as L,d as R,e as E,f as F,h as S,s as k}from"./index-DKI9W503.js";import{I as B}from"./input-C9Pd3zb6.js";import{u as M,T as O}from"./index.esm-HoAAh9rV.js";import{L as z}from"./label-DN2y_0kz.js";import{g as I,u as P,a as T,d as U}from"./galleryQueries-v0xrKYnN.js";import{d as A,T as V,L as D,X as K,P as Z}from"./utils-DejK46WY.js";function G(e,a){if(null==e)return{};var s,t,i={},r=Object.keys(e);for(t=0;t<r.length;t++)s=r[t],a.indexOf(s)>=0||(i[s]=e[s]);return i}var q=["color"],_=u.forwardRef((function(e,a){var s=e.color,t=void 0===s?"currentColor":s,i=G(e,q);return u.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i,{ref:a}),u.createElement("path",{d:"M4.93179 5.43179C4.75605 5.60753 4.75605 5.89245 4.93179 6.06819C5.10753 6.24392 5.39245 6.24392 5.56819 6.06819L7.49999 4.13638L9.43179 6.06819C9.60753 6.24392 9.89245 6.24392 10.0682 6.06819C10.2439 5.89245 10.2439 5.60753 10.0682 5.43179L7.81819 3.18179C7.73379 3.0974 7.61933 3.04999 7.49999 3.04999C7.38064 3.04999 7.26618 3.0974 7.18179 3.18179L4.93179 5.43179ZM10.0682 9.56819C10.2439 9.39245 10.2439 9.10753 10.0682 8.93179C9.89245 8.75606 9.60753 8.75606 9.43179 8.93179L7.49999 10.8636L5.56819 8.93179C5.39245 8.75606 5.10753 8.75606 4.93179 8.93179C4.75605 9.10753 4.75605 9.39245 4.93179 9.56819L7.18179 11.8182C7.35753 11.9939 7.64245 11.9939 7.81819 11.8182L10.0682 9.56819Z",fill:t,fillRule:"evenodd",clipRule:"evenodd"}))})),Q=["color"],Y=u.forwardRef((function(e,a){var s=e.color,t=void 0===s?"currentColor":s,i=G(e,Q);return u.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i,{ref:a}),u.createElement("path",{d:"M11.4669 3.72684C11.7558 3.91574 11.8369 4.30308 11.648 4.59198L7.39799 11.092C7.29783 11.2452 7.13556 11.3467 6.95402 11.3699C6.77247 11.3931 6.58989 11.3355 6.45446 11.2124L3.70446 8.71241C3.44905 8.48022 3.43023 8.08494 3.66242 7.82953C3.89461 7.57412 4.28989 7.55529 4.5453 7.78749L6.75292 9.79441L10.6018 3.90792C10.7907 3.61902 11.178 3.53795 11.4669 3.72684Z",fill:t,fillRule:"evenodd",clipRule:"evenodd"}))})),$=["color"],H=u.forwardRef((function(e,a){var s=e.color,t=void 0===s?"currentColor":s,i=G(e,$);return u.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i,{ref:a}),u.createElement("path",{d:"M3.13523 6.15803C3.3241 5.95657 3.64052 5.94637 3.84197 6.13523L7.5 9.56464L11.158 6.13523C11.3595 5.94637 11.6759 5.95657 11.8648 6.15803C12.0536 6.35949 12.0434 6.67591 11.842 6.86477L7.84197 10.6148C7.64964 10.7951 7.35036 10.7951 7.15803 10.6148L3.15803 6.86477C2.95657 6.67591 2.94637 6.35949 3.13523 6.15803Z",fill:t,fillRule:"evenodd",clipRule:"evenodd"}))})),J=["color"],W=u.forwardRef((function(e,a){var s=e.color,t=void 0===s?"currentColor":s,i=G(e,J);return u.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i,{ref:a}),u.createElement("path",{d:"M3.13523 8.84197C3.3241 9.04343 3.64052 9.05363 3.84197 8.86477L7.5 5.43536L11.158 8.86477C11.3595 9.05363 11.6759 9.04343 11.8648 8.84197C12.0536 8.64051 12.0434 8.32409 11.842 8.13523L7.84197 4.38523C7.64964 4.20492 7.35036 4.20492 7.15803 4.38523L3.15803 8.13523C2.95657 8.32409 2.94637 8.64051 3.13523 8.84197Z",fill:t,fillRule:"evenodd",clipRule:"evenodd"}))}));const X=x,ee=g,ae=u.forwardRef((({className:t,children:i,...r},l)=>e.jsxs(a,{ref:l,className:j("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...r,children:[i,e.jsx(s,{asChild:!0,children:e.jsx(_,{className:"h-4 w-4 opacity-50"})})]})));ae.displayName=a.displayName;const se=u.forwardRef((({className:a,...s},i)=>e.jsx(t,{ref:i,className:j("flex cursor-default items-center justify-center py-1",a),...s,children:e.jsx(W,{})})));se.displayName=t.displayName;const te=u.forwardRef((({className:a,...s},t)=>e.jsx(i,{ref:t,className:j("flex cursor-default items-center justify-center py-1",a),...s,children:e.jsx(H,{})})));te.displayName=i.displayName;const ie=u.forwardRef((({className:a,children:s,position:t="popper",...i},c)=>e.jsx(r,{children:e.jsxs(l,{ref:c,className:j("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===t&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:t,...i,children:[e.jsx(se,{}),e.jsx(n,{className:j("p-1","popper"===t&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),e.jsx(te,{})]})})));ie.displayName=l.displayName;u.forwardRef((({className:a,...s},t)=>e.jsx(c,{ref:t,className:j("px-2 py-1.5 text-sm font-semibold",a),...s}))).displayName=c.displayName;const re=u.forwardRef((({className:a,children:s,...t},i)=>e.jsxs(d,{ref:i,className:j("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...t,children:[e.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(o,{children:e.jsx(Y,{className:"h-4 w-4"})})}),e.jsx(m,{children:s})]})));re.displayName=d.displayName;async function le(e){return new Promise(((a,s)=>{const t=new Image,i=document.createElement("canvas"),r=i.getContext("2d");t.onload=()=>{let e=t.width,l=t.height;const n=1200;e>l?e>n&&(l=Math.round(l*n/e),e=n):l>n&&(e=Math.round(e*n/l),l=n),i.width=e,i.height=l,r?(r.drawImage(t,0,0,e,l),i.toBlob((e=>{e?a(e):i.toBlob((e=>{e?a(e):s(new Error("Failed to process image"))}),"image/jpeg",.85)}),"image/webp",.85)):s(new Error("Failed to get canvas context"))},t.onerror=()=>{s(new Error("Failed to load image"))},t.src=URL.createObjectURL(e)}))}function ne(e){if(0===e)return"0 Bytes";const a=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,a)).toFixed(2))+" "+["Bytes","KB","MB","GB"][a]}function ce(){p();const[a,s]=u.useState([]),[t,i]=u.useState(null),[r,l]=u.useState(""),[n,c]=u.useState("toyger"),[d,o]=u.useState(""),[m,h]=u.useState(""),[x,g]=u.useState(!1);u.useEffect((()=>{f()}),[]);const f=async()=>{try{const e=await I();s(e)}catch(e){}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-card p-6 rounded-lg shadow",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Cat Gallery Manager"}),e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),t){g(!0);try{const e=await P(t);await T({image_url:e,category:n,title:d,description:m}),i(null),l(""),o(""),h(""),await f()}catch(a){alert("Error uploading image. Please try again.")}finally{g(!1)}}},className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(z,{htmlFor:"category",children:"Category"}),e.jsxs(X,{value:n,onValueChange:e=>c(e),children:[e.jsx(ae,{children:e.jsx(ee,{placeholder:"Select category"})}),e.jsxs(ie,{children:[e.jsx(re,{value:"toyger",children:"Toyger"}),e.jsx(re,{value:"bengal",children:"Bengal"})]})]})]}),e.jsxs("div",{children:[e.jsx(z,{htmlFor:"title",children:"Title (Optional)"}),e.jsx(B,{id:"title",value:d,onChange:e=>o(e.target.value),placeholder:"Enter image title"})]}),e.jsxs("div",{children:[e.jsx(z,{htmlFor:"description",children:"Description (Optional)"}),e.jsx(B,{id:"description",value:m,onChange:e=>h(e.target.value),placeholder:"Enter image description"})]}),e.jsxs("div",{children:[e.jsx(z,{htmlFor:"image",children:"Image"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(w,{type:"button",variant:"outline",onClick:()=>{var e;return null==(e=document.getElementById("image"))?void 0:e.click()},children:[e.jsx(A,{className:"w-4 h-4 mr-2"}),"Select Image"]}),e.jsx(B,{id:"image",type:"file",accept:"image/*",className:"hidden",onChange:async e=>{var a;const s=null==(a=e.target.files)?void 0:a[0];if(s)try{const e=await le(s),a=new File([e],s.name,{type:"image/jpeg"});i(a),l(URL.createObjectURL(e))}catch(t){alert("Error processing image. Please try again.")}}})]})]}),r&&e.jsx("div",{className:"mt-4",children:e.jsx("img",{src:r,alt:"Preview",className:"max-w-xs rounded-lg shadow"})}),e.jsx(w,{type:"submit",disabled:!t||x,className:"w-full",children:x?"Uploading...":"Upload Image"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:a.map((a=>e.jsxs(v,{className:"p-4",children:[e.jsx("img",{src:a.image_url,alt:a.title||"Gallery image",className:"w-full h-48 object-cover rounded-lg"}),e.jsxs("div",{className:"mt-2",children:[a.title&&e.jsx("h3",{className:"font-semibold",children:a.title}),a.description&&e.jsx("p",{className:"text-sm text-muted-foreground",children:a.description}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsx(b,{variant:"outline",children:a.category}),e.jsx(w,{variant:"destructive",size:"sm",onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this image?"))try{await U(e),await f()}catch(a){}})(a.id),children:e.jsx(V,{className:"w-4 h-4"})})]})]})]},a.id)))})]})}u.forwardRef((({className:a,...s},t)=>e.jsx(h,{ref:t,className:j("-mx-1 my-1 h-px bg-muted",a),...s}))).displayName=h.displayName;const de=()=>{const a=f(),{t:s}=p(),[t,i]=u.useState([]),[r,l]=u.useState(null),[n,c]=u.useState(!1),[d,o]=u.useState(null),[m,h]=u.useState([]),{register:x,handleSubmit:g,reset:j,setValue:I,formState:{errors:P}}=M();u.useEffect((()=>{T()}),[]),u.useEffect((()=>{r?(I("name",r.name),I("breed",r.breed),I("description",r.description||""),I("price",r.price||""),I("age",r.age||""),I("gender",r.gender||void 0),h(r.images)):(j(),h([]),o(null))}),[r,I,j]);const T=async()=>{try{const e=await N();i(e),y(e)}catch(e){}};return e.jsxs("div",{className:"flex flex-col min-h-screen bg-black",children:[e.jsx(C,{}),e.jsxs("main",{className:"flex-grow container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:s("admin.title")}),e.jsxs(w,{variant:"outline",onClick:async()=>{try{await k.auth.signOut(),a("/login")}catch(e){}},className:"border-red-500 text-red-500 hover:bg-red-500 hover:text-white flex items-center gap-2",children:[e.jsx(D,{className:"h-4 w-4"}),s("admin.logout")]})]}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-lg p-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-6",children:s("admin.kittenManagement")}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-lg p-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-6",children:s(r?"admin.editKitten":"admin.addKitten")}),e.jsxs("form",{onSubmit:g((async e=>{try{c(!0);let a=(null==r?void 0:r.images)||[];if(null==d?void 0:d.length){a=await R(d)}if(0===a.length)throw new Error("At least one image is required");const s={...e,images:a,gender:e.gender||void 0};r?await E(r.id,s):await F(s),await T(),l(null),j(),o(null),h([])}catch(a){alert(a instanceof Error?a.message:"Error saving kitten")}finally{c(!1)}})),className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"name",className:"text-white",children:"Name"}),e.jsx(B,{id:"name",...x("name",{required:!0}),className:"bg-white/10 border-white/20 text-white"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"breed",className:"text-white",children:"Breed"}),e.jsxs(X,{value:null==r?void 0:r.breed,onValueChange:e=>I("breed",e),children:[e.jsx(ae,{className:"bg-white/10 border-white/20 text-white",children:e.jsx(ee,{placeholder:"Select breed"})}),e.jsxs(ie,{children:[e.jsx(re,{value:"Toyger",children:"Toyger"}),e.jsx(re,{value:"Bengal",children:"Bengal"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"description",className:"text-white",children:"Description"}),e.jsx(O,{id:"description",...x("description"),className:"bg-white/10 border-white/20 text-white min-h-[100px]"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"price",className:"text-white",children:"Price"}),e.jsx(B,{id:"price",...x("price"),className:"bg-white/10 border-white/20 text-white"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"age",className:"text-white",children:"Age"}),e.jsx(B,{id:"age",...x("age"),className:"bg-white/10 border-white/20 text-white"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"gender",className:"text-white",children:"Gender"}),e.jsxs(X,{onValueChange:e=>{I("gender",e)},defaultValue:null==r?void 0:r.gender,children:[e.jsx(ae,{className:"bg-white/10 border-white/20 text-white",children:e.jsx(ee,{placeholder:"Select gender"})}),e.jsxs(ie,{children:[e.jsx(re,{value:"Male",children:"Male"}),e.jsx(re,{value:"Female",children:"Female"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(z,{htmlFor:"images",children:"Images"}),e.jsx(B,{id:"images",type:"file",accept:"image/*",multiple:!0,max:5,onChange:async e=>{const a=e.target.files;if(a&&a.length>0){if(a.length>5)return void alert("You can only upload up to 5 images");c(!0);try{const e=new DataTransfer,s=[];for(const t of Array.from(a)){const a=await le(t),i=new File([a],t.name,{type:"image/jpeg"});e.items.add(i),s.push(URL.createObjectURL(a))}o(e.files),h(s)}catch(s){alert("Error processing images. Please try again.")}finally{c(!1)}}},disabled:n,className:"mt-2"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Max 5 images. Images will be automatically resized to max 1200x1200px."})]}),n&&e.jsxs("div",{className:"flex items-center space-x-2 text-amber-400",children:[e.jsx(A,{className:"animate-pulse",size:20}),e.jsx("span",{children:"Processing images..."})]}),m.length>0&&e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 mt-4",children:m.map(((a,s)=>e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:a,alt:`Preview ${s+1}`,className:"w-full aspect-square object-cover rounded-lg"}),e.jsx("button",{type:"button",onClick:()=>(e=>{if(h((a=>a.filter(((a,s)=>s!==e)))),d){const a=new DataTransfer;Array.from(d).filter(((a,s)=>s!==e)).forEach((e=>a.items.add(e))),o(a.files)}})(s),className:"absolute top-2 right-2 p-1 bg-black/50 hover:bg-black/75 rounded-full text-white",children:e.jsx(K,{size:16})}),d&&e.jsx("div",{className:"absolute bottom-2 left-2 right-2 bg-black/50 text-white text-xs px-2 py-1 rounded",children:ne(Array.from(d)[s].size)})]},a)))})]}),e.jsxs("div",{className:"flex gap-4 pt-4",children:[e.jsx(w,{type:"submit",className:"flex-1 bg-amber-600 hover:bg-amber-700 text-white",disabled:n,children:n?"Saving...":r?"Update Kitten":"Add Kitten"}),r&&e.jsx(w,{type:"button",variant:"outline",onClick:()=>l(null),className:"border-white/20 text-white hover:bg-white/10",children:"Cancel"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-6",children:"Current Listings"}),t.map((a=>e.jsxs(v,{className:"bg-white/5 backdrop-blur-sm border-white/10 p-4 flex gap-4",children:[e.jsx("img",{src:a.images[0],alt:a.name,className:"w-24 h-24 object-cover rounded"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:a.name}),e.jsx(b,{variant:"outline",className:""+("Toyger"===a.breed?"bg-amber-500/10 text-amber-500":"bg-orange-500/10 text-orange-500"),children:a.breed})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(w,{variant:"ghost",size:"icon",onClick:()=>l(a),className:"text-white hover:bg-white/10",children:e.jsx(Z,{className:"h-4 w-4"})}),e.jsx(w,{variant:"ghost",size:"icon",onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this kitten?"))try{await S(e),await T()}catch(a){}})(a.id),className:"text-red-500 hover:bg-red-500/10",children:e.jsx(V,{className:"h-4 w-4"})})]})]}),a.description&&e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:a.description}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[a.age&&e.jsx(b,{variant:"secondary",className:"bg-emerald-500/10 text-emerald-500",children:a.age}),a.gender&&e.jsx(b,{variant:"secondary",className:"bg-emerald-500/10 text-emerald-500",children:a.gender}),a.price&&e.jsx(b,{variant:"secondary",className:"bg-emerald-500/10 text-emerald-500",children:a.price})]})]})]},a.id)))]})]})]}),e.jsx(ce,{})]})]}),e.jsx(L,{})]})};export{de as default};
//# sourceMappingURL=AdminDashboard-AFynSAf6.js.map
